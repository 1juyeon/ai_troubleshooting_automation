#!/usr/bin/env python3
# -*- coding: utf-8 -*-

from chroma_vector_classifier import ChromaVectorClassifier

def test_comprehensive():
    """í¬ê´„ì ì¸ ë¶„ë¥˜ê¸° í…ŒìŠ¤íŠ¸"""
    print("=== í¬ê´„ì ì¸ ë¬¸ì œìœ í˜• ë¶„ë¥˜ê¸° í…ŒìŠ¤íŠ¸ ===\n")
    
    # ë¶„ë¥˜ê¸° ì´ˆê¸°í™”
    classifier = ChromaVectorClassifier()
    
    # ë‹¤ì–‘í•œ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë“¤
    test_cases = [
        # ë¹„ë°€ë²ˆí˜¸ ê´€ë ¨
        ("ë¹„ë°€ë²ˆí˜¸ê°€ ë§ì§€ ì•ŠìŠµë‹ˆë‹¤", "í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ê°€ ë§ì§€ ì•ŠìŠµë‹ˆë‹¤"),
        ("íŒ¨ìŠ¤ì›Œë“œ ì¸ì¦ ì‹¤íŒ¨", "í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ê°€ ë§ì§€ ì•ŠìŠµë‹ˆë‹¤"),
        ("CCTV ì›¹ ë¡œê·¸ì¸ ì‹¤íŒ¨", "í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ê°€ ë§ì§€ ì•ŠìŠµë‹ˆë‹¤"),
        ("ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ì´ ì•ˆë©ë‹ˆë‹¤", "ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤"),
        ("íŒ¨ìŠ¤ì›Œë“œ ìˆ˜ì • ì‹¤íŒ¨", "ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤"),
        
        # VMS ê´€ë ¨
        ("VMS í†µì‹  ì‹¤íŒ¨", "VMSì™€ì˜ í†µì‹ ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤"),
        ("VMS ì„œë²„ ì—°ê²° ì•ˆë¨", "VMSì™€ì˜ í†µì‹ ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤"),
        ("NVRê³¼ VMS í†µì‹  ì˜¤ë¥˜", "VMSì™€ì˜ í†µì‹ ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤"),
        
        # ë„¤íŠ¸ì›Œí¬ ê´€ë ¨
        ("Ping í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨", "Ping í…ŒìŠ¤íŠ¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤"),
        ("ë„¤íŠ¸ì›Œí¬ ì—°ê²° ì•ˆë¨", "Ping í…ŒìŠ¤íŠ¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤"),
        ("í†µì‹  í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨", "Ping í…ŒìŠ¤íŠ¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤"),
        
        # Onvif ê´€ë ¨
        ("Onvif ì‘ë‹µ ì—†ìŒ", "Onvif ì‘ë‹µì´ ì—†ìŠµë‹ˆë‹¤"),
        ("ì¹´ë©”ë¼ Onvif í†µì‹  ì•ˆë¨", "Onvif ì‘ë‹µì´ ì—†ìŠµë‹ˆë‹¤"),
        ("Onvif í”„ë¡œí† ì½œ ì˜¤ë¥˜", "Onvif ì‘ë‹µì´ ì—†ìŠµë‹ˆë‹¤"),
        
        # ë¡œê·¸ì¸ ì°¨ë‹¨ ê´€ë ¨
        ("ë¡œê·¸ì¸ ì°¨ë‹¨ë¨", "ë¡œê·¸ì¸ ì°¨ë‹¨ ìƒíƒœì…ë‹ˆë‹¤"),
        ("ê³„ì • ì ê¸ˆ ìƒíƒœ", "ë¡œê·¸ì¸ ì°¨ë‹¨ ìƒíƒœì…ë‹ˆë‹¤"),
        ("CCTV ì°¨ë‹¨ ìƒíƒœ", "ë¡œê·¸ì¸ ì°¨ë‹¨ ìƒíƒœì…ë‹ˆë‹¤"),
        
        # PK P ê³„ì • ê´€ë ¨
        ("PK P ê³„ì • ë¡œê·¸ì¸ ì•ˆë¨", "PK P ê³„ì • ë¡œê·¸ì¸ ì•ˆë¨"),
        ("30ì¼ ë¯¸ì ‘ì†ìœ¼ë¡œ ì ê¹€", "PK P ê³„ì • ë¡œê·¸ì¸ ì•ˆë¨"),
        ("ê³„ì •ì´ ì ê²¼ìŠµë‹ˆë‹¤", "PK P ê³„ì • ë¡œê·¸ì¸ ì•ˆë¨"),
        
        # PK P ì›¹ ê´€ë ¨
        ("PK P ì›¹ ì ‘ì† ì•ˆë¨", "PK P ì›¹ ì ‘ì† ì•ˆë¨"),
        ("ì›¹ì‚¬ì´íŠ¸ ì ‘ì† ì‹¤íŒ¨", "PK P ì›¹ ì ‘ì† ì•ˆë¨"),
        ("í†°ìº£ ì„œë¹„ìŠ¤ ì¤‘ë‹¨", "PK P ì›¹ ì ‘ì† ì•ˆë¨"),
        ("ì›¹ í˜ì´ì§€ ë¡œë“œ ì•ˆë¨", "PK P ì›¹ ì ‘ì† ì•ˆë¨"),
        
        # ê¸°íƒ€
        ("ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜", "ê¸°íƒ€"),
        ("ì‹œìŠ¤í…œ ì˜¤ë¥˜ ë°œìƒ", "ê¸°íƒ€"),
        ("ì˜ˆìƒì¹˜ ëª»í•œ ë¬¸ì œ", "ê¸°íƒ€")
    ]
    
    print("=== ë¶„ë¥˜ ì •í™•ë„ í…ŒìŠ¤íŠ¸ ===\n")
    
    correct_count = 0
    total_count = len(test_cases)
    
    for i, (input_text, expected_type) in enumerate(test_cases, 1):
        print(f"--- í…ŒìŠ¤íŠ¸ {i:2d} ---")
        print(f"ì…ë ¥: {input_text}")
        print(f"ì˜ˆìƒ: {expected_type}")
        
        try:
            result = classifier.classify_issue(input_text)
            predicted_type = result['issue_type']
            confidence = result['confidence']
            method = result['method']
            
            is_correct = predicted_type == expected_type
            if is_correct:
                correct_count += 1
                status = "âœ…"
            else:
                status = "âŒ"
            
            print(f"ê²°ê³¼: {predicted_type} ({confidence}) [{method}] {status}")
            
            if 'matched_keywords' in result and result['matched_keywords']:
                print(f"í‚¤ì›Œë“œ: {result['matched_keywords']}")
            
        except Exception as e:
            print(f"âŒ ì˜¤ë¥˜: {e}")
        
        print()
    
    # ì •í™•ë„ ê³„ì‚°
    accuracy = (correct_count / total_count) * 100
    print(f"=== í…ŒìŠ¤íŠ¸ ê²°ê³¼ ===")
    print(f"ì´ í…ŒìŠ¤íŠ¸: {total_count}ê°œ")
    print(f"ì •í™•í•œ ë¶„ë¥˜: {correct_count}ê°œ")
    print(f"ì •í™•ë„: {accuracy:.1f}%")
    
    if accuracy >= 80:
        print("ğŸ‰ ìš°ìˆ˜í•œ ë¶„ë¥˜ ì„±ëŠ¥!")
    elif accuracy >= 60:
        print("ğŸ‘ ì–‘í˜¸í•œ ë¶„ë¥˜ ì„±ëŠ¥")
    else:
        print("âš ï¸ ë¶„ë¥˜ ì„±ëŠ¥ ê°œì„  í•„ìš”")

if __name__ == "__main__":
    test_comprehensive()
